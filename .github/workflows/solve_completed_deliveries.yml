name: SolveCompletedDeliveries
# probe-only 1772184200
on:
  push:
    branches: [assistant-video-deliveries-1772178394]
    paths:
      - '.github/workflows/solve_completed_deliveries.yml'
permissions:
  contents: write
jobs:
  solve:
    if: github.actor != 'github-actions[bot]'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Write probe output
        run: |
          mkdir -p outputs
          python - <<'PY'
          import json, time
          with open('outputs/solve_completed_deliveries.json', 'w', encoding='utf-8') as f:
              json.dump({'probe': 'ok', 'ts': int(time.time())}, f, indent=2)
          PY
          cat outputs/solve_completed_deliveries.json
      - name: Commit result
        if: always()
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add outputs/solve_completed_deliveries.json
          git commit -m "Write completed deliveries output" || exit 0
          for i in 1 2 3 4 5; do
            git pull --rebase origin assistant-video-deliveries-1772178394 && git push origin HEAD:assistant-video-deliveries-1772178394 && exit 0 || true
            sleep 10
          done
          exit 0
